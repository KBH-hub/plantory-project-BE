<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zero.plantoryprojectbe.member.MemberMapper">

    <select id="selectByMemberId" parameterType="long" resultType="com.zero.plantoryprojectbe.profile.dto.MemberResponse">
        SELECT member_id, membername, password, nickname, phone, address,
               sharing_rate, skill_rate, management_rate,
               role, stop_day, del_flag
        FROM member
        WHERE member_id = #{memberId}
          AND del_flag IS NULL
    </select>

    <update id="resetStopDay">
        UPDATE member
        SET stop_day = NULL
        WHERE member_id = #{memberId}
    </update>


    <select id="countByMembername" resultType="int">
        SELECT COUNT(*)
        FROM member
        WHERE membername = #{membername}
          AND del_flag IS NULL
    </select>

    <select id="countByNickname" resultType="int">
        SELECT COUNT(*)
        FROM member
        WHERE nickname = #{nickname}
          AND del_flag IS NULL
    </select>

    <insert id="insertMember" parameterType="com.zero.plantoryprojectbe.profile.dto.MemberResponse">
        INSERT INTO member (
            membername, password, nickname, phone, address,
            sharing_rate, skill_rate, management_rate,
            role, stop_day, del_flag, created_at, notice_enabled
        )
        VALUES (
                   #{membername}, #{password}, #{nickname},
                   #{phone}, #{address},
                   #{sharingRate}, #{skillRate}, #{managementRate},
                   #{role}, #{stopDay}, #{delFlag},
                   NOW(), #{noticeEnabled}
               )
    </insert>

    <select id="selectByMembername" parameterType="string" resultType="com.zero.plantoryprojectbe.profile.dto.MemberResponse">
        SELECT member_id, membername, password, nickname, phone, address,
               sharing_rate, skill_rate, management_rate,
               role, stop_day, del_flag
        FROM member
        WHERE membername = #{membername}
          AND del_flag IS NULL
    </select>

    <delete id="deleteByMemberId" parameterType="long">
        DELETE FROM member
        WHERE member_id = #{memberId}
    </delete>
</mapper>
